<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Reporte de Movimientos</title>
    <style type="text/css">
        body { font-family: Helvetica, sans-serif; color: #333; }
        h1 { text-align: center; color: #0056b3; }
        .header { margin-bottom: 20px; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background-color: #f2f2f2; padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
        td { padding: 8px; border-bottom: 1px solid #eee; }
        .footer { position: fixed; bottom: 0px; font-size: 10px; text-align: center; color: #888; }
        .total-row { font-weight: bold; background-color: #e9ecef; }
    </style>
</head>
<body>
    <div class="header">
        <h1>{{ titulo }}</h1>
        <p><strong>Generado por:</strong> {{ usuario.nombres }} {{ usuario.apellidos }}<br>
           <strong>Fecha:</strong> {{ fecha_impresion|date:"d/m/Y H:i" }}</p>
    </div>

    <h3>Resumen Estadístico</h3>
    <table>
        <thead>
            <tr>
                {% for col in data.columnas %}
                <th>{{ col }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for item in data.detalles %}
            <tr>
                {% if data.es_anual %}
                    <td>{{ item.nombre }}</td> {% elif data.columnas.0 == 'Estado' %}
                    <td>{{ item.estado|title }}</td>
                {% else %}
                    <td>{{ item.tipo_movimiento__nombre }}</td>
                {% endif %}
                
                <td>{{ item.total }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="2">No hay datos para este reporte.</td></tr>
            {% endfor %}
            
            <tr class="total-row">
                <td>TOTAL GENERAL</td>
                <td>{{ total_general }}</td>
            </tr>
        </tbody>
    </table>

    <div class="footer">
        Reporte generado automáticamente por Sistema Discopro
    </div>
</body>
</html>